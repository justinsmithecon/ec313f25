setwd("~/Library/CloudStorage/OneDrive-WilfridLaurierUniversity/Teaching/EC313/assignments")
library(tidyverse)
library(here)
# Read in data
dataorig <- read_csv(here("taxburdentobacco.csv"))
View(dataorig)
library(janitor)
# Read in data
dataorig <- read_csv(here("taxburdentobacco.csv")) %>% clean_names()
View(dataorig)
View(dataorig)
dataorig <- read_csv(here("taxburdentobacco.csv")) %>% clean_names() %>%
select(-c(topic_desc, measure_desc, datasource))
View(dataorig)
names(dataorig)
dataorig <- read_csv(here("taxburdentobacco.csv")) %>% clean_names() %>%
select(c(location_abbr,location_desc,year,sub_measure_desc,data_value ))
dataorig <- read_csv(here("taxburdentobacco.csv")) %>% clean_names() %>%
select(c(location_abbr,location_desc,year,sub_measure_desc,data_value )) %>%
pivot_wider(names_from = sub_measure_desc, values_from = data_value)
View(dataorig)
dataorig <- read_csv(here("taxburdentobacco.csv")) %>% clean_names() %>%
select(c(location_abbr,location_desc,year,sub_measure_desc,data_value )) %>%
pivot_wider(names_from = sub_measure_desc, values_from = data_value) %>%
clean_names()
names(dataorig)
dataorig <- read_csv(here("taxburdentobacco.csv")) %>% clean_names() %>%
select(c(location_abbr,location_desc,year,sub_measure_desc,data_value )) %>%
pivot_wider(names_from = sub_measure_desc, values_from = data_value) %>%
clean_names() %>%
rename(state_abbr = location_abbr, state_name = location_desc,
cost_per_pack = average_cost_per_pack,
state_tax_percent = federal_and_state_tax_as_a_percentage_of_retail_price,
cig_tax_rev = gross_cigarette_tax_revenue,
cig_sales_percapita = cigarette_consumption_pack_sales_per_capita)
dataorig <- read_csv(here("taxburdentobacco.csv")) %>% clean_names() %>%
select(c(location_abbr,location_desc,year,sub_measure_desc,data_value )) %>%
pivot_wider(names_from = sub_measure_desc, values_from = data_value) %>%
clean_names() %>%
rename(state_abbr = location_abbr, state_name = location_desc,
cost_per_pack = average_cost_per_pack,
state_tax_percent = federal_and_state_tax_as_a_percentage_of_retail_price,
cig_tax_rev = gross_cigarette_tax_revenue,
cig_sales_percapita = cigarette_consumption_pack_sales_per_capita,
fed_state_tax_per_pack = federal_and_state_tax_per_pack)
dataorig <- read_csv(here("taxburdentobacco.csv")) %>% clean_names() %>%
select(c(location_abbr,location_desc,year,sub_measure_desc,data_value )) %>%
pivot_wider(names_from = sub_measure_desc, values_from = data_value) %>%
clean_names() %>%
rename(state_abbr = location_abbr, state_name = location_desc,
cost_per_pack = average_cost_per_pack,
fed_state_tax_percent = federal_and_state_tax_as_a_percentage_of_retail_price,
cig_tax_rev = gross_cigarette_tax_revenue,
cig_sales_percapita = cigarette_consumption_pack_sales_per_capita,
fed_state_tax_per_pack = federal_and_state_tax_per_pack)
.42/1.048
library(haven)
write_dta(dataorig, here("taxburdentobacco.dta"))
View(dataorig)
names(dataorig)
setwd("~/Library/CloudStorage/OneDrive-WilfridLaurierUniversity/Teaching/EC313/assignments")
library(tidyverse)
library(tibble)
data <- tibble(
income = c(20000, 30000, 40000, 50000, 60000, 70000, 80000)
)
data <- tibble(
income = c(20000, 30000, 40000, 50000, 60000, 70000, 80000),
rev1 = -3000 + 0.25*income
)
View(data)
data <- tibble(
income = c(20000, 30000, 40000, 50000, 60000, 70000, 80000),
rev1 = -3000 + 0.25*income,
rev2 = -5000 + 0.25*income,
rev3 = -3000 + 0.5*income,
prop1 = rev1/income,
prop2 = rev2/income,
prop3 = rev3/income
)
View(data)
plotrev <- data %>%
pivot_longer(cols = starts_with("rev"), names_to = "type", values_to = "revenue") %>%
ggplot(aes(x = income, y = revenue, color = type)) +
geom_line(size = 1.2) +
geom_hline(yintercept = 0, linetype = "dashed", color = "black") +
scale_x_continuous(labels = scales::dollar_format()) +
scale_y_continuous(labels = scales::dollar_format()) +
labs(
title = "Revenue vs Income",
x = "Income",
y = "Revenue",
color = "Tax Type"
) +
theme_minimal()
plotrev
data <- tibble(
income = c(0, 10000, 20000, 30000, 40000, 50000, 60000, 70000, 80000),
rev1 = -3000 + 0.25*income,
rev2 = -5000 + 0.25*income,
rev3 = -3000 + 0.5*income,
prop1 = rev1/income,
prop2 = rev2/income,
prop3 = rev3/income
)
plotrev <- data %>%
pivot_longer(cols = starts_with("rev"), names_to = "type", values_to = "revenue") %>%
ggplot(aes(x = income, y = revenue, color = type)) +
geom_line(size = 1.2) +
geom_hline(yintercept = 0, linetype = "dashed", color = "black") +
scale_x_continuous(labels = scales::dollar_format()) +
scale_y_continuous(labels = scales::dollar_format()) +
labs(
title = "Revenue vs Income",
x = "Income",
y = "Revenue",
color = "Tax Type"
) +
theme_minimal()
plotrev
plotprop <- data %>%
pivot_longer(cols = starts_with("prop"), names_to = "type", values_to = "proportion") %>%
ggplot(aes(x = income, y = proportion, color = type)) +
geom_line(size = 1.2) +
scale_x_continuous(labels = scales::dollar_format()) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
labs(
title = "Proportion of Income vs Income",
x = "Income",
y = "Proportion of Income",
color = "Tax Type"
) +
theme_minimal()
plotprop
plotrev <- data %>%
pivot_longer(
cols = starts_with("rev"),
names_to = "type",
values_to = "revenue"
) %>%
ggplot(aes(x = income, y = revenue, color = type)) +
geom_line(size = 1.2) +
geom_hline(yintercept = 0, linetype = "dashed", color = "black") +
scale_x_continuous(labels = scales::dollar_format()) +
scale_y_continuous(labels = scales::dollar_format()) +
scale_color_manual(
name = "Specification",
values = c("rev1" = "red", "rev2" = "blue", "rev3" = "green"),
labels = c(
"rev1" = expression(alpha == -3000 ~ ", " ~ t == 0.25),
"rev2" = expression(alpha == -5000 ~ ", " ~ t == 0.25),
"rev3" = expression(alpha == -3000 ~ ", " ~ t == 0.5)
)
) +
labs(
title = "Revenue vs Income",
x = "Income",
y = "Revenue"
) +
theme_minimal()
plotrev
plotprop <- data %>%
pivot_longer(cols = starts_with("prop"), names_to = "type", values_to = "proportion") %>%
ggplot(aes(x = income, y = proportion, color = type)) +
geom_line(size = 1.2) +
scale_x_continuous(labels = scales::dollar_format()) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_color_manual(
name = "Specification",
values = c("rev1" = "red", "rev2" = "blue", "rev3" = "green"),
labels = c(
"rev1" = expression(alpha == -3000 ~ ", " ~ t == 0.25),
"rev2" = expression(alpha == -5000 ~ ", " ~ t == 0.25),
"rev3" = expression(alpha == -3000 ~ ", " ~ t == 0.5)
)
) +
labs(
title = "Proportion of Income vs Income",
x = "Income",
y = "Proportion of Income",
color = "Tax Type"
) +
theme_minimal()
plotprop
plotprop <- data %>%
pivot_longer(cols = starts_with("prop"), names_to = "type", values_to = "proportion") %>%
ggplot(aes(x = income, y = proportion, color = type)) +
geom_line(size = 1.2) +
scale_x_continuous(labels = scales::dollar_format()) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_color_manual(
name = "Specification",
values = c("prop1" = "red", "prop2" = "blue", "prop3" = "green"),
labels = c(
"rev1" = expression(alpha == -3000 ~ ", " ~ t == 0.25),
"rev2" = expression(alpha == -5000 ~ ", " ~ t == 0.25),
"rev3" = expression(alpha == -3000 ~ ", " ~ t == 0.5)
)
) +
labs(
title = "Proportion of Income vs Income",
x = "Income",
y = "Proportion of Income",
color = "Tax Type"
) +
theme_minimal()
plotprop
plotprop <- data %>%
pivot_longer(
cols = starts_with("prop"),
names_to = "type",
values_to = "proportion"
) %>%
ggplot(aes(x = income, y = proportion, color = type)) +
geom_line(size = 1.2) +
scale_x_continuous(labels = scales::dollar_format()) +
scale_y_continuous(labels = scales::percent_format(accuracy = 1)) +
scale_color_manual(
name = "Specification",
values = c("prop1" = "red", "prop2" = "blue", "prop3" = "green"),
labels = c(
"prop1" = expression(alpha == -3000 ~ ", " ~ t == 0.25),
"prop2" = expression(alpha == -5000 ~ ", " ~ t == 0.25),
"prop3" = expression(alpha == -3000 ~ ", " ~ t == 0.5)
)
) +
labs(
title = "Proportion of Income vs Income",
x = "Income",
y = "Proportion of Income"
) +
theme_minimal()
plotprop
View(data)
