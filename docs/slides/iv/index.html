<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>index – EC313 - Taxation</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e1a5c8363afafaef2c763b6775fbf3ca.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-fd90b21108f641f33a068e1e0674373f.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">EC313 - Taxation</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../content/index.html"> 
<span class="menu-text">Content</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../assignments/index.html"> 
<span class="menu-text">Assignments</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a>
  <ul class="collapse">
  <li><a href="#introduction-1" id="toc-introduction-1" class="nav-link" data-scroll-target="#introduction-1">Introduction</a></li>
  </ul></li>
  <li><a href="#instrumental-variables" id="toc-instrumental-variables" class="nav-link" data-scroll-target="#instrumental-variables">Instrumental Variables</a>
  <ul class="collapse">
  <li><a href="#model" id="toc-model" class="nav-link" data-scroll-target="#model">Model</a></li>
  <li><a href="#model-1" id="toc-model-1" class="nav-link" data-scroll-target="#model-1">Model</a></li>
  <li><a href="#model-2" id="toc-model-2" class="nav-link" data-scroll-target="#model-2">Model</a></li>
  <li><a href="#model-3" id="toc-model-3" class="nav-link" data-scroll-target="#model-3">Model</a></li>
  <li><a href="#model-4" id="toc-model-4" class="nav-link" data-scroll-target="#model-4">Model</a></li>
  <li><a href="#model-5" id="toc-model-5" class="nav-link" data-scroll-target="#model-5">Model</a></li>
  <li><a href="#model-6" id="toc-model-6" class="nav-link" data-scroll-target="#model-6">Model</a></li>
  <li><a href="#estimation-by-method-of-moments" id="toc-estimation-by-method-of-moments" class="nav-link" data-scroll-target="#estimation-by-method-of-moments">Estimation by Method of Moments</a></li>
  </ul></li>
  <li><a href="#two-stage-least-squares" id="toc-two-stage-least-squares" class="nav-link" data-scroll-target="#two-stage-least-squares">Two-Stage Least Squares</a>
  <ul class="collapse">
  <li><a href="#overview" id="toc-overview" class="nav-link" data-scroll-target="#overview">Overview</a></li>
  <li><a href="#structural-equation" id="toc-structural-equation" class="nav-link" data-scroll-target="#structural-equation">Structural Equation</a></li>
  <li><a href="#first-stage" id="toc-first-stage" class="nav-link" data-scroll-target="#first-stage">First Stage</a></li>
  <li><a href="#first-stage-1" id="toc-first-stage-1" class="nav-link" data-scroll-target="#first-stage-1">First Stage</a></li>
  <li><a href="#second-stage" id="toc-second-stage" class="nav-link" data-scroll-target="#second-stage">Second Stage</a></li>
  <li><a href="#second-stage-1" id="toc-second-stage-1" class="nav-link" data-scroll-target="#second-stage-1">Second Stage</a></li>
  <li><a href="#second-stage-2" id="toc-second-stage-2" class="nav-link" data-scroll-target="#second-stage-2">Second Stage</a></li>
  <li><a href="#dag" id="toc-dag" class="nav-link" data-scroll-target="#dag">DAG</a></li>
  <li><a href="#estimation-by-method-of-moments-1" id="toc-estimation-by-method-of-moments-1" class="nav-link" data-scroll-target="#estimation-by-method-of-moments-1">Estimation by Method of Moments</a></li>
  <li><a href="#estimation-by-method-of-moments-2" id="toc-estimation-by-method-of-moments-2" class="nav-link" data-scroll-target="#estimation-by-method-of-moments-2">Estimation by Method of Moments</a></li>
  <li><a href="#estimation-by-method-of-moments-3" id="toc-estimation-by-method-of-moments-3" class="nav-link" data-scroll-target="#estimation-by-method-of-moments-3">Estimation by Method of Moments</a></li>
  <li><a href="#intuition" id="toc-intuition" class="nav-link" data-scroll-target="#intuition">Intuition</a></li>
  <li><a href="#intuition-1" id="toc-intuition-1" class="nav-link" data-scroll-target="#intuition-1">Intuition</a></li>
  </ul></li>
  <li><a href="#statistical-properties-of-tsls" id="toc-statistical-properties-of-tsls" class="nav-link" data-scroll-target="#statistical-properties-of-tsls">Statistical Properties of TSLS</a>
  <ul class="collapse">
  <li><a href="#introduction-2" id="toc-introduction-2" class="nav-link" data-scroll-target="#introduction-2">Introduction</a></li>
  <li><a href="#assumptions" id="toc-assumptions" class="nav-link" data-scroll-target="#assumptions">Assumptions</a></li>
  <li><a href="#assumptions-1" id="toc-assumptions-1" class="nav-link" data-scroll-target="#assumptions-1">Assumptions</a></li>
  <li><a href="#consistency" id="toc-consistency" class="nav-link" data-scroll-target="#consistency">Consistency</a></li>
  <li><a href="#unbiasedness" id="toc-unbiasedness" class="nav-link" data-scroll-target="#unbiasedness">Unbiasedness</a></li>
  <li><a href="#large-sample-distribution-of-boldsymbolhatbeta" id="toc-large-sample-distribution-of-boldsymbolhatbeta" class="nav-link" data-scroll-target="#large-sample-distribution-of-boldsymbolhatbeta">Large Sample Distribution of <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span></a></li>
  <li><a href="#variance-estimator-for-boldsymbolhatbeta" id="toc-variance-estimator-for-boldsymbolhatbeta" class="nav-link" data-scroll-target="#variance-estimator-for-boldsymbolhatbeta">Variance Estimator for <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span></a></li>
  <li><a href="#variance-estimator-for-boldsymbolhatbeta-1" id="toc-variance-estimator-for-boldsymbolhatbeta-1" class="nav-link" data-scroll-target="#variance-estimator-for-boldsymbolhatbeta-1">Variance Estimator for <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span></a></li>
  </ul></li>
  <li><a href="#structural-and-reduced-form-in-tsls" id="toc-structural-and-reduced-form-in-tsls" class="nav-link" data-scroll-target="#structural-and-reduced-form-in-tsls">Structural and Reduced Form in TSLS</a>
  <ul class="collapse">
  <li><a href="#structural-vs-reduced-form-equations" id="toc-structural-vs-reduced-form-equations" class="nav-link" data-scroll-target="#structural-vs-reduced-form-equations">Structural vs Reduced form Equations</a></li>
  <li><a href="#structural-vs-reduced-form-equations-1" id="toc-structural-vs-reduced-form-equations-1" class="nav-link" data-scroll-target="#structural-vs-reduced-form-equations-1">Structural vs Reduced form Equations</a></li>
  <li><a href="#structural-vs-reduced-form-equations-2" id="toc-structural-vs-reduced-form-equations-2" class="nav-link" data-scroll-target="#structural-vs-reduced-form-equations-2">Structural vs Reduced form Equations</a></li>
  </ul></li>
  <li><a href="#checking-instrument-validity" id="toc-checking-instrument-validity" class="nav-link" data-scroll-target="#checking-instrument-validity">Checking Instrument Validity</a>
  <ul class="collapse">
  <li><a href="#introduction-3" id="toc-introduction-3" class="nav-link" data-scroll-target="#introduction-3">Introduction</a></li>
  <li><a href="#introduction-4" id="toc-introduction-4" class="nav-link" data-scroll-target="#introduction-4">Introduction</a></li>
  <li><a href="#exclusion-restriction" id="toc-exclusion-restriction" class="nav-link" data-scroll-target="#exclusion-restriction">Exclusion Restriction</a></li>
  <li><a href="#exclusion-restriction-1" id="toc-exclusion-restriction-1" class="nav-link" data-scroll-target="#exclusion-restriction-1">Exclusion Restriction</a></li>
  <li><a href="#exclusion-restriction-2" id="toc-exclusion-restriction-2" class="nav-link" data-scroll-target="#exclusion-restriction-2">Exclusion Restriction</a></li>
  <li><a href="#instrument-relevance" id="toc-instrument-relevance" class="nav-link" data-scroll-target="#instrument-relevance">Instrument Relevance</a></li>
  <li><a href="#instrument-relevance-1" id="toc-instrument-relevance-1" class="nav-link" data-scroll-target="#instrument-relevance-1">Instrument Relevance</a></li>
  <li><a href="#instrument-relevance-2" id="toc-instrument-relevance-2" class="nav-link" data-scroll-target="#instrument-relevance-2">Instrument Relevance</a></li>
  <li><a href="#instrument-relevance-3" id="toc-instrument-relevance-3" class="nav-link" data-scroll-target="#instrument-relevance-3">Instrument Relevance</a></li>
  <li><a href="#instrument-relevance-4" id="toc-instrument-relevance-4" class="nav-link" data-scroll-target="#instrument-relevance-4">Instrument Relevance</a></li>
  <li><a href="#instrument-relevance-5" id="toc-instrument-relevance-5" class="nav-link" data-scroll-target="#instrument-relevance-5">Instrument Relevance</a></li>
  <li><a href="#instrument-relevance-6" id="toc-instrument-relevance-6" class="nav-link" data-scroll-target="#instrument-relevance-6">Instrument Relevance</a></li>
  </ul></li>
  <li><a href="#interpretation-of-slope-in-iv-models" id="toc-interpretation-of-slope-in-iv-models" class="nav-link" data-scroll-target="#interpretation-of-slope-in-iv-models">Interpretation of Slope in IV Models</a>
  <ul class="collapse">
  <li><a href="#introduction-5" id="toc-introduction-5" class="nav-link" data-scroll-target="#introduction-5">Introduction</a></li>
  <li><a href="#local-average-treatment-effects" id="toc-local-average-treatment-effects" class="nav-link" data-scroll-target="#local-average-treatment-effects">Local Average Treatment Effects</a></li>
  <li><a href="#local-average-treatment-effects-1" id="toc-local-average-treatment-effects-1" class="nav-link" data-scroll-target="#local-average-treatment-effects-1">Local Average Treatment Effects</a></li>
  <li><a href="#local-average-treatment-effects-2" id="toc-local-average-treatment-effects-2" class="nav-link" data-scroll-target="#local-average-treatment-effects-2">Local Average Treatment Effects</a></li>
  <li><a href="#local-average-treatment-effects-3" id="toc-local-average-treatment-effects-3" class="nav-link" data-scroll-target="#local-average-treatment-effects-3">Local Average Treatment Effects</a></li>
  <li><a href="#local-average-treatment-effects-4" id="toc-local-average-treatment-effects-4" class="nav-link" data-scroll-target="#local-average-treatment-effects-4">Local Average Treatment Effects</a></li>
  <li><a href="#local-average-treatment-effects-5" id="toc-local-average-treatment-effects-5" class="nav-link" data-scroll-target="#local-average-treatment-effects-5">Local Average Treatment Effects</a></li>
  <li><a href="#local-average-treatment-effects-6" id="toc-local-average-treatment-effects-6" class="nav-link" data-scroll-target="#local-average-treatment-effects-6">Local Average Treatment Effects</a></li>
  <li><a href="#examples-of-late" id="toc-examples-of-late" class="nav-link" data-scroll-target="#examples-of-late">Examples of LATE</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="index.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block"></header>




<h1>
Instrumental Variables
</h1>
<hr>
<h2 class="anchored">
EC655 - Econometrics
</h2>
<h2 class="anchored">
Justin Smith
</h2>
<h2 class="anchored">
Wilfrid Laurier University
</h2>
<h2 class="anchored">
Fall 2023
</h2>
<p><img src="../../files/img/hexEC655.png" class="absolute img-fluid" data-top="300" data-left="900" width="550"></p>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
✔ dplyr     1.1.4     ✔ readr     2.1.5
✔ forcats   1.0.0     ✔ stringr   1.5.1
✔ ggplot2   3.5.2     ✔ tibble    3.2.1
✔ lubridate 1.9.4     ✔ tidyr     1.3.1
✔ purrr     1.0.4     
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
ℹ Use the conflicted package (&lt;http://conflicted.r-lib.org/&gt;) to force all conflicts to become errors
Loading required package: kableExtra


Attaching package: 'kableExtra'


The following object is masked from 'package:dplyr':

    group_rows



Attaching package: 'ggdag'


The following object is masked from 'package:stats':

    filter</code></pre>
</div>
</div>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<section id="introduction-1" class="level2">
<h2 class="anchored" data-anchor-id="introduction-1">Introduction</h2>
<ul>
<li><p>In many empirical applications we want to estimate a causal effect</p>
<ul>
<li>The independent effect of a particular variable on the outcome</li>
</ul></li>
<li><p>OLS is inconsistent for this parameter when the error is correlated with <span class="math inline">\(\mathbf{x}\)</span></p>
<ul>
<li><p>This happens often with omitted variables</p></li>
<li><p>Also, simultaneous equations, measurement error in <span class="math inline">\(\mathbf{x}\)</span></p></li>
</ul></li>
<li><p>If we want to consistently estimate causal parameter, we need a different method</p></li>
<li><p>First method we will discuss is <strong>Instrumental Variables</strong></p></li>
</ul>
</section>
</section>
<section id="instrumental-variables" class="level1">
<h1>Instrumental Variables</h1>
<section id="model" class="level2">
<h2 class="anchored" data-anchor-id="model">Model</h2>
<ul>
<li><p>Start with a population linear model</p>
<p><span class="math display">\[y =  \mathbf{x}\boldsymbol{\beta}  + e\]</span></p></li>
<li><p>Define <span class="math inline">\(\boldsymbol{\beta}\)</span> as the <strong>causal effect</strong></p></li>
<li><p>A model like the above where <span class="math inline">\(\boldsymbol{\beta}\)</span> is the causal effect is called a <strong>Structural Model</strong></p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The model above is <em>not</em> the same as the population regression we discussed previously. In this model we are defining <span class="math inline">\(\boldsymbol{\beta}\)</span> specifically as the causal effect, and therefore <span class="math inline">\(e\)</span> is not the same as the regression residual we defined before.</p>
</div>
</div>
</section>
<section id="model-1" class="level2">
<h2 class="anchored" data-anchor-id="model-1">Model</h2>
<ul>
<li><p>Suppose we think some parts of <span class="math inline">\(\mathbf{x}\)</span> are correlated with <span class="math inline">\(e\)</span> so that</p>
<p><span class="math display">\[\textbf{E}(\mathbf{x'}e) \neq 0\]</span></p></li>
<li><p>The population least squares regression is not equal to the causal effect</p></li>
</ul>
<p><span class="math display">\[\boldsymbol{\beta^{*}}=(\textbf{E}[\mathbf{x'x}])^{-1} \textbf{E}[\mathbf{x}'y]\]</span> <span class="math display">\[=(\textbf{E}[\mathbf{x'x}])^{-1} \textbf{E}[\mathbf{x}'(\mathbf{x}\boldsymbol{\beta}  + e)]\]</span> <span class="math display">\[=\boldsymbol{\beta} + (\textbf{E}[\mathbf{x'x}])^{-1}\textbf{E}[\mathbf{x'}e]\]</span></p>
</section>
<section id="model-2" class="level2">
<h2 class="anchored" data-anchor-id="model-2">Model</h2>
<ul>
<li><p>In this setup, the OLS estimate of <span class="math inline">\(\boldsymbol{\beta^{*}}\)</span> is inconsistent for <span class="math inline">\(\boldsymbol{\beta}\)</span></p>
<ul>
<li>This bias could come from omitted variables, but also other sources</li>
</ul></li>
<li><p>If we want a consistent estimate of <span class="math inline">\(\boldsymbol{\beta}\)</span> we need another method</p></li>
<li><p>To make things simpler, partition the independent variables</p></li>
</ul>
<p><span class="math display">\[=  \mathbf{x_{1}}\boldsymbol{\beta_{1}}  + x_{k}\beta_{k}  + e\]</span></p>
<ul>
<li><p>Suppose that <span class="math inline">\(x_{k}\)</span> is correlated with <span class="math inline">\(e\)</span>, but <span class="math inline">\(\mathbf{x_{1}}\)</span> is not</p>
<ul>
<li><span class="math inline">\(x_{k}\)</span> is <strong>endogenous</strong></li>
<li><span class="math inline">\(\mathbf{x_{1}}\)</span> is <strong>exogenous</strong></li>
</ul></li>
</ul>
</section>
<section id="model-3" class="level2">
<h2 class="anchored" data-anchor-id="model-3">Model</h2>
<ul>
<li><p>Now imagine we have an <strong>instrumental variable</strong> <span class="math inline">\(z_{1}\)</span> that is</p>
<ul>
<li><p>Uncorrelated with <span class="math inline">\(e\)</span></p></li>
<li><p>Correlated with <span class="math inline">\(x_{k}\)</span></p></li>
</ul></li>
<li><p>Define the vector <span class="math inline">\(\mathbf{z}\)</span> to be</p>
<p><span class="math display">\[\mathbf{z} = [1,x_{1}, x_{2}, ...,x_{k-1},z_{1}]\]</span></p>
<ul>
<li><p>It is the <span class="math inline">\(\mathbf{x}\)</span> vector with <span class="math inline">\(z_{1}\)</span> in place of <span class="math inline">\(x_{k}\)</span></p>
<ul>
<li><p><span class="math inline">\(\mathbf{x_{1}}\)</span> are <strong>included instruments</strong></p></li>
<li><p><span class="math inline">\(z_{1}\)</span> is the <strong>excluded instrument</strong> because it comes from outside the model</p></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="model-4" class="level2">
<h2 class="anchored" data-anchor-id="model-4">Model</h2>
<ul>
<li><p>If all factors in <span class="math inline">\(\mathbf{z}\)</span> are exogenous,</p>
<p><span class="math display">\[\mathbf{E}(\mathbf{z}'e) = 0\]</span></p></li>
<li><p>If we take our model</p>
<p><span class="math display">\[y =  \mathbf{x}\boldsymbol{\beta}  + e\]</span></p></li>
<li><p>Pre-multiply by <span class="math inline">\(\mathbf{z}\)</span> and take expectations</p>
<p><span class="math display">\[\mathbf{E}(\mathbf{z}'y) = \mathbf{E}(\mathbf{z'x}) \boldsymbol{\beta}  + \mathbf{E}(\mathbf{z}'u)\]</span></p>
<p><span class="math display">\[\boldsymbol{\beta}  = [\mathbf{E}(\mathbf{z'x})] ^{-1}\mathbf{E}(\mathbf{z}'y)\]</span></p></li>
</ul>
</section>
<section id="model-5" class="level2">
<h2 class="anchored" data-anchor-id="model-5">Model</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The population <strong>Instrumental Variables</strong> slope vector with one instrument for each endogenous variable is</p>
<p><span class="math display">\[\boldsymbol{\beta}  = [\mathbf{E}(\mathbf{z'x})] ^{-1}\mathbf{E}(\mathbf{z}'y)\]</span></p>
</div>
</div>
</section>
<section id="model-6" class="level2">
<h2 class="anchored" data-anchor-id="model-6">Model</h2>
<ul>
<li><p>To be able to identify <span class="math inline">\(\boldsymbol{\beta}\)</span>, we need to assume</p>
<ul>
<li><p><strong>Rank condition:</strong> <span class="math inline">\(\text{rank }\mathbf{E}(\mathbf{z'z}) = K+1\)</span></p>
<ul>
<li>The variables in <span class="math inline">\(\mathbf{z}\)</span> are linearly independent</li>
</ul></li>
<li><p><strong>Relevance condition:</strong> <span class="math inline">\(\text{rank }\mathbf{E}(\mathbf{z'x}) = K+1\)</span></p>
<ul>
<li>The instrument is correlated with the endogenous variable</li>
</ul></li>
</ul></li>
<li><p>Combined with the orthogonality condition <span class="math inline">\(\mathbf{E}(\mathbf{z}'e) = 0\)</span> this means an instrument must be</p>
<ul>
<li><p>Uncorrelated with the error term</p></li>
<li><p>Correlated with the endogenous variable</p></li>
</ul></li>
</ul>
</section>
<section id="estimation-by-method-of-moments" class="level2">
<h2 class="anchored" data-anchor-id="estimation-by-method-of-moments">Estimation by Method of Moments</h2>
<ul>
<li><p>Applying the method of moments to the population slope</p>
<p><span class="math display">\[\boldsymbol{\hat{\beta}}=\left ( \frac{1}{n}\sum_{i=1}^{n}\mathbf{z_{i}'x_{i}} \right )^{-1} \left ( \frac{1}{n} \sum_{i=1}^{n}\mathbf{z}_{i}'y_{i}\right ) = \left ( \sum_{i=1}^{n}\mathbf{z_{i}'x_{i}} \right )^{-1} \left ( \sum_{i=1}^{n}\mathbf{z}_{i}'y_{i}\right )\]</span></p>
<p><span class="math display">\[=\left ( \mathbf{Z'X} \right )^{-1} \left ( \mathbf{Z'y}\right )\]</span></p></li>
<li><p>The IV estimator is very similar to the OLS estimator, except</p>
<ul>
<li>The <span class="math inline">\(\mathbf{X'}\)</span> matrix that premultiplies the <span class="math inline">\(\mathbf{X}\)</span> matrix and <span class="math inline">\(\mathbf{y}\)</span> vector is replaced with <span class="math inline">\(\mathbf{Z'}\)</span></li>
</ul></li>
</ul>
</section>
</section>
<section id="two-stage-least-squares" class="level1">
<h1>Two-Stage Least Squares</h1>
<section id="overview" class="level2">
<h2 class="anchored" data-anchor-id="overview">Overview</h2>
<ul>
<li><p>In some cases we have more than one instrument for an endogenous variable</p></li>
<li><p>Two-Stage Least Squares (TSLS) generalizes the IV model for this situation</p>
<ul>
<li>Note: In practice, both models are often called Instrumental Variables</li>
</ul></li>
<li><p>The TSLS procedure is</p>
<ul>
<li><p><strong>First Stage</strong>: regress endogenous variable on all exogenous variables</p></li>
<li><p><strong>Second Stage</strong>: regress dependent variable on exogenous <span class="math inline">\(\mathbf{x}\)</span> variables and predicted value of endogenous variable from first stage</p></li>
</ul></li>
<li><p>This process keeps only exogenous part of endogenous variable in the second stage</p>
<ul>
<li>Purges the endogenous variable of the endogenous component</li>
</ul></li>
</ul>
</section>
<section id="structural-equation" class="level2">
<h2 class="anchored" data-anchor-id="structural-equation">Structural Equation</h2>
<ul>
<li><p>To see this mathematically, the structural equation is</p>
<p><span class="math display">\[y =  \mathbf{x_{1}}\boldsymbol{\beta_{1}}  + x_{k}\beta_{k}  + e\]</span></p>
<ul>
<li><span class="math inline">\(x_{k}\)</span> is endogenous, and <span class="math inline">\(\mathbf{x_{1}}\)</span> are exogenous</li>
</ul></li>
<li><p>The vector <span class="math inline">\(\mathbf{z}\)</span> is now</p>
<p><span class="math display">\[\mathbf{z} = [1,x_{1}, x_{2}, ...,x_{k-1},z_{1}, z_{2},...,z_{m}]\]</span></p>
<ul>
<li><p>Contains <span class="math inline">\(K\)</span> exogenous <span class="math inline">\(\mathbf{x}\)</span> variables and <span class="math inline">\(M\)</span> instruments</p></li>
<li><p>Total dimension of this vector is <span class="math inline">\(L=K+M\)</span></p></li>
</ul></li>
<li><p>There are at least as many instruments as endogenous variables</p></li>
<li><p>If <span class="math inline">\(\mathbf{z}\)</span> is exogenous, <span class="math inline">\(\mathbf{E}(\mathbf{z}'e) = 0\)</span></p></li>
</ul>
</section>
<section id="first-stage" class="level2">
<h2 class="anchored" data-anchor-id="first-stage">First Stage</h2>
<ul>
<li>In the first stage regress endogenous variables on <span class="math inline">\(\mathbf{z}\)</span></li>
</ul>
<p><span class="math display">\[x_{k} =  \mathbf{z}\boldsymbol{\pi}   + r\]</span></p>
<ul>
<li><span class="math inline">\(\boldsymbol{\pi}\)</span> is the population least squares slope vector</li>
</ul>
<p><span class="math display">\[\boldsymbol{\pi} = \left ( \mathbf{E}(\mathbf{z'z}) \right )^{-1} \mathbf{E}(\mathbf{z'x_{k}})\]</span></p>
<ul>
<li>The population regression function in this relationship is</li>
</ul>
<p><span class="math display">\[\mathbf{x}_{k}^{*} =  \mathbf{z}\boldsymbol{\pi}\]</span></p>
</section>
<section id="first-stage-1" class="level2">
<h2 class="anchored" data-anchor-id="first-stage-1">First Stage</h2>
<ul>
<li><p>The intuition behind the first stage is</p>
<ul>
<li><p>The first stage regresses the endogenous variable on the instruments</p></li>
<li><p>It separates the endogenous variable into the exogenous part and the endogenous part</p></li>
<li><p>The predicted value is the exogenous part</p></li>
<li><p>The residual is the endogenous part</p></li>
<li><p>We only keep the exogenous part for the second stage</p></li>
</ul></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>In the first stage regression, regress the endogenous variable <span class="math inline">\(x_{k}\)</span> on <em>all</em> the exogenous variables <span class="math inline">\(x_{1}\)</span> and <span class="math inline">\(z_{1} \ldots z_{m}\)</span>.</p>
</div>
</div>
</section>
<section id="second-stage" class="level2">
<h2 class="anchored" data-anchor-id="second-stage">Second Stage</h2>
<ul>
<li><p>In the second stage, replace <span class="math inline">\(x_{k}\)</span> with <span class="math inline">\(\mathbf{x}_{k}^{*}\)</span></p></li>
<li><p>So the vector <span class="math inline">\(\mathbf{x}^{*}\)</span> is</p>
<p><span class="math display">\[\mathbf{x}^{*} = [1,x_{1}, x_{2}, ...,x_{k-1},x_{k}^{*}]\]</span></p></li>
<li><p>If <span class="math inline">\(\mathbf{z}\)</span> is exogenous, then so is a linear combination of the <span class="math inline">\(\mathbf{z}\)</span></p>
<ul>
<li><span class="math inline">\(x_{k}^{*}\)</span> is a linear combination of <span class="math inline">\(\mathbf{z}\)</span></li>
</ul></li>
<li><p>So we know that <span class="math inline">\(\mathbf{E}(\mathbf{x}^{*'}e) = 0\)</span></p></li>
<li><p>Premultiply structural equation by <span class="math inline">\(\mathbf{x}^{*'}\)</span> and take expectations</p>
<p><span class="math display">\[\mathbf{E}(\mathbf{x}^{*'}y) = \mathbf{E}(\mathbf{x^{*'}x}) \boldsymbol{\beta}  + \mathbf{E}(\mathbf{x}^{*'}e)\]</span></p></li>
</ul>
</section>
<section id="second-stage-1" class="level2">
<h2 class="anchored" data-anchor-id="second-stage-1">Second Stage</h2>
<ul>
<li>Use <span class="math inline">\(\mathbf{E}(\mathbf{x}^{*'}e) = 0\)</span> and solve for <span class="math inline">\(\boldsymbol{\beta}\)</span></li>
</ul>
<p><span class="math display">\[\boldsymbol{\beta}  = \left(\mathbf{E}(\mathbf{x^{*'}x})\right)^{-1}\mathbf{E}(\mathbf{x}^{*'}y)\]</span></p>
<ul>
<li>It is equivalent to write this as</li>
</ul>
<p><span class="math display">\[\boldsymbol{\beta}  = \left(\mathbf{E}(\mathbf{x^{*'}x^{*}})\right)^{-1}\mathbf{E}(\mathbf{x}^{*'}y)\]</span></p>
<ul>
<li>It is the population regression slope of <span class="math inline">\(y\)</span> on <span class="math inline">\(\mathbf{x}^{*}\)</span></li>
</ul>
</section>
<section id="second-stage-2" class="level2">
<h2 class="anchored" data-anchor-id="second-stage-2">Second Stage</h2>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The TSLS regression slope vector is</p>
<p><span class="math display">\[\boldsymbol{\beta}  = \left(\mathbf{E}(\mathbf{x^{*'}x^{*}})\right)^{-1}\mathbf{E}(\mathbf{x}^{*'}y)\]</span></p>
</div>
</div>
<ul>
<li><p>Note that the IV estimator is <em>equivalent</em> to TSLS when there is one instrument for one endogenous variable</p></li>
<li><p>As before, these are population moments that we cannot compute directly</p></li>
<li><p>We need to estimate them</p></li>
</ul>
</section>
<section id="dag" class="level2">
<h2 class="anchored" data-anchor-id="dag">DAG</h2>
<div class="columns">
<div class="column" style="width:50%;">
<ul>
<li><p>Instrumental variables can be depicted in a DAG</p></li>
<li><p>There is an unobserved confounder <span class="math inline">\(e\)</span></p>
<ul>
<li>We cannot control for it</li>
</ul></li>
<li><p>Instrumental variable <span class="math inline">\(z\)</span> is correlated with <span class="math inline">\(x\)</span> and uncorrelated with <span class="math inline">\(e\)</span></p></li>
<li><p>It only affects <span class="math inline">\(y\)</span> through <span class="math inline">\(x_k\)</span></p></li>
</ul>
</div><div class="column" style="width:50%;">
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="index_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid quarto-figure quarto-figure-center figure-img" style="width:90.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="estimation-by-method-of-moments-1" class="level2">
<h2 class="anchored" data-anchor-id="estimation-by-method-of-moments-1">Estimation by Method of Moments</h2>
<ul>
<li><p>As before, substitute sample versions of population moments to get</p></li>
<li><p>Also recall that this is a two-step process</p></li>
<li><p>The <strong>first stage</strong>, is the regression of <span class="math inline">\(\mathbf{x}\)</span> on <span class="math inline">\(\mathbf{z}\)</span></p></li>
<li><p>The population slope vector is is</p></li>
</ul>
<p><span class="math display">\[\boldsymbol{\pi} = \left ( \mathbf{E}(\mathbf{z'z}) \right )^{-1} \mathbf{E}(\mathbf{z'x_{k}})\]</span></p>
<ul>
<li>The sample version is</li>
</ul>
<p><span class="math display">\[\boldsymbol{\hat{\pi}} = \left( \mathbf{Z'Z} \right)^{-1}\mathbf{Z'x_{k}}\]</span></p>
</section>
<section id="estimation-by-method-of-moments-2" class="level2">
<h2 class="anchored" data-anchor-id="estimation-by-method-of-moments-2">Estimation by Method of Moments</h2>
<ul>
<li>The predicted values of <span class="math inline">\(x_{k}\)</span> are</li>
</ul>
<p><span class="math display">\[\mathbf{\hat{x}}_{k} = \mathbf{Z}\boldsymbol{\hat{\pi}}\]</span></p>
<ul>
<li><p>The <strong>second stage</strong> replaces <span class="math inline">\(x_{k}\)</span> with <span class="math inline">\(\mathbf{\hat{x}}_{k}\)</span></p></li>
<li><p>The sample regression slope vector is</p></li>
</ul>
<p><span class="math display">\[\boldsymbol{\hat{\beta}}  = \left( \mathbf{\mathbf{\hat{X}}'\mathbf{\hat{X}}} \right)^{-1}\mathbf{\mathbf{\hat{X}}'y}\]</span></p>
</section>
<section id="estimation-by-method-of-moments-3" class="level2">
<h2 class="anchored" data-anchor-id="estimation-by-method-of-moments-3">Estimation by Method of Moments</h2>
<ul>
<li><p>When there is one endogenous variable, the matrix <span class="math inline">\(\mathbf{\hat{X}}\)</span> is</p>
<p><span class="math display">\[\mathbf{\hat{X}} =
\begin{bmatrix}
1 &amp; x_{11}  &amp; x_{12} &amp;\cdots&amp;x_{1,k-1} &amp; \hat{x}_{1k}\\
1 &amp; x_{21}  &amp; x_{22} &amp;\cdots&amp;x_{2,k-1} &amp; \hat{x}_{2k}\\
\vdots  &amp; \vdots &amp; \ddots &amp;\vdots &amp;\vdots \\
1 &amp; x_{n1}  &amp; x_{n2} &amp;\cdots&amp;x_{n,k-1} &amp; \hat{x}_{nk}
\end{bmatrix}
=
\begin{bmatrix}
\mathbf{X_{1}} &amp; \mathbf{\hat{x}_{k}}
\end{bmatrix}\]</span></p></li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The TSLS estimator is</p>
<p><span class="math display">\[\boldsymbol{\hat{\beta}}  = \left( \mathbf{\mathbf{\hat{X}}'\mathbf{\hat{X}}} \right)^{-1}\mathbf{\mathbf{\hat{X}}'y}\]</span></p>
</div>
</div>
</section>
<section id="intuition" class="level2">
<h2 class="anchored" data-anchor-id="intuition">Intuition</h2>
<ul>
<li><p>The starting point for TSLS is an endogenous variable</p>
<ul>
<li><p>A variable that is correlated with <span class="math inline">\(e\)</span></p></li>
<li><p>Usually because of omitted variables bias</p></li>
</ul></li>
<li><p>OLS will not consistently identify the slope vector <span class="math inline">\(\boldsymbol{\beta}\)</span></p></li>
<li><p>We have access to at least one variable <strong>from outside the model</strong> that is</p>
<ul>
<li><p>Uncorrelated with the error term <span class="math inline">\(e\)</span></p></li>
<li><p>Correlated with the endogenous variable <span class="math inline">\(x_{k}\)</span></p></li>
</ul></li>
</ul>
</section>
<section id="intuition-1" class="level2">
<h2 class="anchored" data-anchor-id="intuition-1">Intuition</h2>
<ul>
<li><p>The first stage regresses <span class="math inline">\(x_{k}\)</span> on <strong>all</strong> exogenous variables</p>
<ul>
<li><p>Separates <span class="math inline">\(x_{k}\)</span> into two pieces</p>
<ul>
<li><p>The exogenous part: the piece that is correlated with the exogenous variables</p></li>
<li><p>The endogenous part: the residual from this regression, which is uncorrelated with the exogenous piece</p></li>
</ul></li>
<li><p>The first stage purges the endogenous component from <span class="math inline">\(x_{k}\)</span></p></li>
<li><p>Keeps only the exogenous component, <span class="math inline">\(\hat{x}_{k}\)</span></p></li>
</ul></li>
<li><p>We use the only the exogenous piece <span class="math inline">\(\hat{x}_{k}\)</span> in the second stage regression</p></li>
</ul>
</section>
</section>
<section id="statistical-properties-of-tsls" class="level1">
<h1>Statistical Properties of TSLS</h1>
<section id="introduction-2" class="level2">
<h2 class="anchored" data-anchor-id="introduction-2">Introduction</h2>
<ul>
<li><p>Like we did with the OLS estimator, we cover the statistical properties of TSLS</p>
<ul>
<li>We will be slightly less detailed</li>
</ul></li>
<li><p>We first need to outline the set of assumptions required for consistency</p></li>
</ul>
</section>
<section id="assumptions" class="level2">
<h2 class="anchored" data-anchor-id="assumptions">Assumptions</h2>
<ol type="1">
<li><p><span class="math inline">\(\mathbf{E}(\mathbf{z}'e) = 0\)</span></p>
<ul>
<li><p>The vector of exogenous variables is uncorrelated with <span class="math inline">\(u\)</span></p></li>
<li><p>This is sometimes called the <strong>exclusion restriction</strong></p>
<ul>
<li>The instruments come from outside the model and are uncorrelated with the error</li>
</ul></li>
</ul></li>
</ol>
</section>
<section id="assumptions-1" class="level2">
<h2 class="anchored" data-anchor-id="assumptions-1">Assumptions</h2>
<ol start="2" type="1">
<li><p><span class="math inline">\(\text{rank } \mathbf{E}(\mathbf{z'z}) = L\)</span> and <span class="math inline">\(\text{rank } \mathbf{E}(\mathbf{z'x}) = K\)</span></p>
<ul>
<li><p>First part says that none of the variables in <span class="math inline">\(\mathbf{z}\)</span> are perfectly collinear</p></li>
<li><p>Second part is the <strong>rank condition</strong></p>
<ul>
<li><p>The instruments must be sufficiently correlated with the endogenous variable</p></li>
<li><p>We will come back to this when we talk about weak instruments</p></li>
</ul></li>
<li><p>For this assumption to hold we also need to meet the <strong>order condition</strong></p>
<ul>
<li><p>There are at least as many instruments as endogenous variables</p></li>
<li><p>Mathematically, we need <span class="math inline">\(L\ge K+1\)</span></p></li>
</ul></li>
</ul></li>
<li><p><span class="math inline">\(\{(\mathbf{x}_{i},\mathbf{z_{i}}, y_{i}: i=1,2,...n)\}\)</span> are a random sample</p></li>
</ol>
</section>
<section id="consistency" class="level2">
<h2 class="anchored" data-anchor-id="consistency">Consistency</h2>
<ul>
<li><p>If all of the assumptions are met, the TSLS estimator is consistent for <span class="math inline">\(\boldsymbol{\beta}\)</span></p></li>
<li><p>We will not do the proof, but it is very similar to OLS</p></li>
<li><p>If any of the assumptions fail, the TSLS estimator is inconsistent</p></li>
</ul>
</section>
<section id="unbiasedness" class="level2">
<h2 class="anchored" data-anchor-id="unbiasedness">Unbiasedness</h2>
<ul>
<li><p>In small samples, the TSLS estimator is generally <strong>biased</strong></p></li>
<li><p>We will not cover the proof</p></li>
<li><p>You should only use TSLS with large samples</p></li>
</ul>
</section>
<section id="large-sample-distribution-of-boldsymbolhatbeta" class="level2">
<h2 class="anchored" data-anchor-id="large-sample-distribution-of-boldsymbolhatbeta">Large Sample Distribution of <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span></h2>
<ul>
<li><p>We again appeal to the Central Limit Theorem</p></li>
<li><p>With large <span class="math inline">\(n\)</span>, the TSLS estimator has a Normal distribution with mean <span class="math inline">\(\boldsymbol{\beta}\)</span> and variance</p>
<p><span class="math display">\[\text{var}(\boldsymbol{\hat{\beta}}) = n^{-1}[\mathbf{E}(\mathbf{x^{*'}x^{*}})^{-1}]\mathbf{E}(u^2\mathbf{x^{*'}x^{*}})[\mathbf{E}(\mathbf{x^{*'}x^{*}})^{-1}]\]</span></p></li>
<li><p>If we assume homoskedasticity <span class="math inline">\(\mathbf{E}(u^2|\mathbf{z}) = \sigma^2\)</span> this reduces to</p>
<p><span class="math display">\[\text{var}(\boldsymbol{\hat{\beta}}) = \sigma^2 n^{-1}\mathbf{E}(\mathbf{x^{*'}x^{*}})^{-1}\]</span></p></li>
</ul>
</section>
<section id="variance-estimator-for-boldsymbolhatbeta" class="level2">
<h2 class="anchored" data-anchor-id="variance-estimator-for-boldsymbolhatbeta">Variance Estimator for <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span></h2>
<ul>
<li><p>To estimate the variance, substitute sample versions of the population moments</p></li>
<li><p>The <strong>Heteroskedasticity-Robust</strong> variance estimator is</p>
<p><span class="math display">\[\hat{\text{var}}(\boldsymbol{\hat{\beta}}) = \left (\mathbf{\hat{X}'\hat{X}}\right )^{-1}\left ( \sum_{i=1}^{n}\hat{u}_{i}^2\mathbf{\hat{x}_{i}'\hat{x}_{i}}\right )\left ( \mathbf{\hat{X}'\hat{X}}\right )^{-1}\]</span></p></li>
<li><p>If we assume <strong>homoskedasticity</strong>, it is</p>
<p><span class="math display">\[\hat{\text{var}}(\boldsymbol{\hat{\beta}}) = s_{\hat{u}}^2 \left (\mathbf{\hat{X}'\hat{X}}\right )^{-1}\]</span></p></li>
<li><p>In both cases, we use the <strong>TSLS residuals</strong>, which are</p>
<p><span class="math display">\[\mathbf{\hat{u}} = \mathbf{y} - \mathbf{X}\boldsymbol{\hat{\beta}}\]</span></p></li>
</ul>
</section>
<section id="variance-estimator-for-boldsymbolhatbeta-1" class="level2">
<h2 class="anchored" data-anchor-id="variance-estimator-for-boldsymbolhatbeta-1">Variance Estimator for <span class="math inline">\(\boldsymbol{\hat{\beta}}\)</span></h2>
<ul>
<li><p>These are <u>not</u> the residuals from the second stage regression <span class="math inline">\(\mathbf{y} - \mathbf{\hat{X}}\boldsymbol{\hat{\beta}}\)</span></p>
<ul>
<li><p>Use <span class="math inline">\(\mathbf{X}\)</span> – not <span class="math inline">\(\mathbf{\hat{X}}\)</span> – in this calculation</p></li>
<li><p>This is a common mistake</p></li>
<li><p>Using the wrong residuals will lead to incorrect estimates of the standard errors</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="structural-and-reduced-form-in-tsls" class="level1">
<h1>Structural and Reduced Form in TSLS</h1>
<section id="structural-vs-reduced-form-equations" class="level2">
<h2 class="anchored" data-anchor-id="structural-vs-reduced-form-equations">Structural vs Reduced form Equations</h2>
<ul>
<li><p>In this section we present details that are useful for using TSLS in practice</p></li>
<li><p>This will help you understand when you read papers using TSLS</p></li>
<li><p>Suppose we have a model with one endogenous variable and one instrument</p></li>
<li><p>The instrumental variables model in scalar notation is</p></li>
</ul>
<p><span class="math display">\[y =  \beta_{0} + x_{1}\beta_{1} +...+ x_{k-1}\beta_{k-1} + x_{k}\beta_{k}  + e\]</span> <span class="math display">\[x_{k} =  \pi_{0} + x_{1}\pi_{1}+...+x_{k-1}\pi_{k-1}  +z_{1}\delta_{1}  + r\]</span></p>
<ul>
<li><p>The first equation is the <strong>structural equation</strong></p>
<ul>
<li>The equation containing the causal effects we are interested in</li>
</ul></li>
</ul>
</section>
<section id="structural-vs-reduced-form-equations-1" class="level2">
<h2 class="anchored" data-anchor-id="structural-vs-reduced-form-equations-1">Structural vs Reduced form Equations</h2>
<ul>
<li><p>The second equation is the first stage</p>
<ul>
<li><p>It is a <strong>reduced form</strong> equation</p>
<ul>
<li><p>All of the regressors are exogenous</p></li>
<li><p>The parameters do not necessarily represent causal effects</p></li>
</ul></li>
</ul></li>
<li><p>Researchers often also estimate the reduced form for <span class="math inline">\(y\)</span></p>
<ul>
<li>Sub the second equation into the first to get</li>
</ul></li>
</ul>
<p><span class="math display">\[y =  (\beta_{0} + \beta_{k}\pi_{0}) + x_{1}(\beta_{1} + \beta_{k}\pi_{1}) +...+ x_{k-1} (\beta_{k-1}+ \beta_{k}\pi_{k-1}) + z_{1}\beta_{k}\delta_{1}  + e + \beta_{k}r\]</span></p>
<p><span class="math display">\[= \gamma_{0}+ x_{1}\gamma_{1}+...+ x_{k-1} \gamma_{k-1}+ z_{1}\theta_{1}+ \epsilon\]</span></p>
<ul>
<li>This is the regression of <span class="math inline">\(y\)</span> on all the exogenous variables</li>
</ul>
</section>
<section id="structural-vs-reduced-form-equations-2" class="level2">
<h2 class="anchored" data-anchor-id="structural-vs-reduced-form-equations-2">Structural vs Reduced form Equations</h2>
<ul>
<li><p>In the reduced form for <span class="math inline">\(y\)</span>, the slope <span class="math inline">\(\theta_{1} = \beta_{k}\delta_{1}\)</span></p>
<ul>
<li>The effect of <span class="math inline">\(z_{1}\)</span> on <span class="math inline">\(x_{k}\)</span> times the effect of <span class="math inline">\(x_{k}\)</span> on <span class="math inline">\(y\)</span></li>
</ul></li>
<li><p>You can get the slope <span class="math inline">\(\beta_{k}\)</span> by dividing the reduced form by the first stage</p>
<p><span class="math display">\[\beta_{k}  = \frac{\theta_{1}}{\delta_{1}}\]</span></p></li>
<li><p><span class="math inline">\(\beta_{k}\)</span> is the reduced form effect scaled by the first stage</p>
<ul>
<li><p>Ex: returns to schooling</p></li>
<li><p>Imagine <span class="math inline">\(y\)</span> is income, <span class="math inline">\(x_{k}\)</span> is years of schooling, <span class="math inline">\(z_{1}\)</span> is kms to nearest university</p></li>
<li><p>If <span class="math inline">\(\delta_{1} = .5\)</span>, being 1km closer to school leads to .5 more years of schooling</p></li>
<li><p>If <span class="math inline">\(\theta_{1} = 10000\)</span>, being 1km closer to school leads to $10000 more income</p></li>
<li><p>Then <span class="math inline">\(\beta_{k} = \frac{10000}{.5} = 20000\)</span> is effect of a year of additional schooling</p></li>
</ul></li>
</ul>
</section>
</section>
<section id="checking-instrument-validity" class="level1">
<h1>Checking Instrument Validity</h1>
<section id="introduction-3" class="level2">
<h2 class="anchored" data-anchor-id="introduction-3">Introduction</h2>
<ul>
<li><p>There are two main assumptions for instrumental variables</p>
<ul>
<li><p><strong>Exclusion restriction</strong>: instruments are from outside the model and uncorrelated with <span class="math inline">\(e\)</span></p></li>
<li><p><strong>Rank condition</strong>: excluded instruments are sufficiently related to the endogenous variable</p>
<ul>
<li>This is sometimes also called the instrument relevance condition</li>
</ul></li>
</ul></li>
<li><p>Failure of either creates problems</p></li>
<li><p>To understand these issues, it is useful to study the following model</p></li>
</ul>
<p><span class="math display">\[y = \beta_{0} + \beta_{1}x_{1} + e\]</span></p>
<p><span class="math display">\[x_{1} = \pi_{0} + \pi_{1}z_{1} + r\]</span></p>
</section>
<section id="introduction-4" class="level2">
<h2 class="anchored" data-anchor-id="introduction-4">Introduction</h2>
<ul>
<li>In this model, you can show that</li>
</ul>
<p><span class="math display">\[\text{plim }\hat{\beta}_{1} = \beta_{1} + \frac{cov(z_{1},e)}{cov(z_{1},x_{1})}\]</span> <span class="math display">\[= \beta_{1} + \frac{\sigma_{e}}{\sigma_{x_{1}}}\frac{corr(z_{1},e)}{corr(z_{1},x_{1})}\]</span></p>
<ul>
<li><p>We will use this result to inform ourselves about the failure of our assumptions</p></li>
<li><p>The key idea is that instruments must be relevant and exogenous</p></li>
</ul>
</section>
<section id="exclusion-restriction" class="level2">
<h2 class="anchored" data-anchor-id="exclusion-restriction">Exclusion Restriction</h2>
<ul>
<li>Consider the plim of the TSLS slope estimator</li>
</ul>
<p><span class="math display">\[\text{plim }\hat{\beta}_{1} = \beta_{1} + \frac{cov(z_{1},e)}{cov(z_{1},x_{1})}\]</span></p>
<ul>
<li><p>If the exclusion restriction holds, then <span class="math inline">\(cov(z_{1},e) = 0\)</span> and <span class="math inline">\(\text{plim }\hat{\beta}_{1} = \beta_{1}\)</span></p></li>
<li><p>If not then <span class="math inline">\(\text{plim }\hat{\beta}_{1} \neq \beta_{1}\)</span> and the TSLS estimator is inconsistent</p></li>
<li><p>Can we check to see if this assumption is true?</p></li>
<li><p>If we have one excluded instrument for each endogenous variable, we cannot</p>
<ul>
<li><p>There are no enough degrees of freedom to test the exclusion restriction</p></li>
<li><p>We have to rely only on our assumptions in this case</p></li>
</ul></li>
</ul>
</section>
<section id="exclusion-restriction-1" class="level2">
<h2 class="anchored" data-anchor-id="exclusion-restriction-1">Exclusion Restriction</h2>
<ul>
<li><p>With multiple excluded instruments for the endogenous variable, we can</p>
<ul>
<li>We use the extra instruments to test whether the others are endogenous</li>
</ul></li>
<li><p>A useful test when errors are homoskedastic is the <strong>Sargan Test</strong></p>
<ul>
<li><p>Estimate the model using TSLS</p></li>
<li><p>Compute the TSLS residuals, <span class="math inline">\(\mathbf{\hat{u}}\)</span></p></li>
<li><p>Regress <span class="math inline">\(\mathbf{\hat{u}}\)</span> on all instruments <span class="math inline">\(\mathbf{z}\)</span></p>
<ul>
<li>Save <span class="math inline">\(R^2_u\)</span> from this regression</li>
</ul></li>
<li><p>The test statistic is <span class="math inline">\(nR^2_u\)</span></p>
<ul>
<li>Has a <span class="math inline">\(\chi^2_{Q_{1}}\)</span> distribution, where <span class="math inline">\(Q_{1}\)</span> are overidentifying restrictions</li>
</ul></li>
<li><p>The null hypothesis is exogeneity</p></li>
</ul></li>
</ul>
</section>
<section id="exclusion-restriction-2" class="level2">
<h2 class="anchored" data-anchor-id="exclusion-restriction-2">Exclusion Restriction</h2>
<ul>
<li><p>There is a more complicated test with heteroskedastic errors</p>
<ul>
<li><p>You can easily execute this in R or Stata</p></li>
<li><p>We can discuss the process separately</p></li>
</ul></li>
<li><p>If you fail this test (reject the null), then you need to find other instruments</p></li>
</ul>
</section>
<section id="instrument-relevance" class="level2">
<h2 class="anchored" data-anchor-id="instrument-relevance">Instrument Relevance</h2>
<ul>
<li><p>For TSLS to work, the instrument must be relevant</p>
<ul>
<li>It must be sufficiently correlated with the endogenous variable</li>
</ul></li>
<li><p>An instrument that is not sufficiently relevant is a <strong>weak instrument</strong></p></li>
<li><p>Weak instruments can cause several problems</p></li>
</ul>
<ol type="1">
<li><p>Inconsistency when the instrument and error are not exactly uncorrelated</p>
<ul>
<li>Consider the plim of the TSLS slope estimator</li>
</ul></li>
</ol>
<p><span class="math display">\[\text{plim }\hat{\beta}_{1} =  \beta_{1} + \frac{\sigma_{e}}{\sigma_{x_{1}}}\frac{corr(z_{1},e)}{corr(z_{1},x_{1})}\]</span></p>
</section>
<section id="instrument-relevance-1" class="level2">
<h2 class="anchored" data-anchor-id="instrument-relevance-1">Instrument Relevance</h2>
<ul>
<li><p>Continued...</p>
<ul>
<li><p>When <span class="math inline">\(corr(z_{1},x_{1}) \rightarrow 0\)</span> then <span class="math inline">\(\frac{corr(z_{1},e)}{corr(z_{1},x_{1})} \rightarrow \infty\)</span></p>
<ul>
<li>True even when <span class="math inline">\(corr(z_{1},e)\)</span> is very close to zero</li>
</ul></li>
<li><p>Also note that the plim of the OLS estimator is</p>
<p><span class="math display">\[\text{plim }\hat{\beta}_{1}^{ols} =  \beta_{1} + \frac{\sigma_{e}}{\sigma_{x_{1}}}corr(x_{1},e)\]</span></p></li>
<li><p>Taking the ratio of the two biases <span class="math display">\[\frac{\hat{\beta}_{1}-\beta_{1}}{\hat{\beta}_{1}^{ols}-\beta_{1}} =  \frac{corr(z_{1},e)/corr(x_{1},e)}{corr(z_{1},x_{1})}\]</span></p></li>
<li><p>As <span class="math inline">\(corr(z_{1},x_{1}) \rightarrow 0\)</span>, the inconsistency in 2SLS becomes larger than the inconsistency in OLS</p></li>
</ul></li>
</ul>
</section>
<section id="instrument-relevance-2" class="level2">
<h2 class="anchored" data-anchor-id="instrument-relevance-2">Instrument Relevance</h2>
<ol start="2" type="1">
<li><p>Finite sample bias in TSLS becomes large</p>
<ul>
<li><p>The expected value of the TSLS estimator can be written as</p>
<p><span class="math display">\[\mathbf{E}(\hat{\beta}_{1} - \beta_{1}) \approx \frac{\sigma_{er}}{\sigma_{r}^2}\frac{1}{F+1}\]</span></p></li>
<li><p>Where <span class="math inline">\(F\)</span> is the F-statistic from the test of joint significance of the excluded regressors</p></li>
<li><p>Weak instruments means that <span class="math inline">\(F\)</span> is close to zero</p></li>
<li><p>As <span class="math inline">\(F\)</span> gets small, the bias tends to <span class="math inline">\(\frac{\sigma_{er}}{\sigma_{r}^2}\)</span></p>
<ul>
<li><p>If <span class="math inline">\(F\)</span> is exactly zero, that means the instrument is irrelevant <span class="math inline">\((\pi_{1}=0)\)</span></p></li>
<li><p>In this case <span class="math inline">\(\frac{\sigma_{er}}{\sigma_{r}^2}\)</span> is also the OLS bias</p></li>
<li><p>So 2SLS and OLS produce the same biased result</p></li>
</ul></li>
<li><p>When instruments are weak, TSLS is biased towards OLS</p></li>
</ul></li>
</ol>
</section>
<section id="instrument-relevance-3" class="level2">
<h2 class="anchored" data-anchor-id="instrument-relevance-3">Instrument Relevance</h2>
<ol start="3" type="1">
<li><p>Standard inference is no longer valid</p>
<ul>
<li><p>We rely in the central limit theorem to show TSLS estimator has a Normal distribution</p></li>
<li><p>With weak instruments, this no longer holds</p>
<ul>
<li>The estimator has the distribution of the ratio of two Normal variables</li>
</ul></li>
<li><p>In this case the t-statistic no longer has a t-distribution</p></li>
<li><p>Hypothesis tests tend to reject the null more than it should</p></li>
</ul></li>
</ol>
</section>
<section id="instrument-relevance-4" class="level2">
<h2 class="anchored" data-anchor-id="instrument-relevance-4">Instrument Relevance</h2>
<ul>
<li>There are several tests available to check for weak instruments</li>
</ul>
<ol type="1">
<li><p>Test with one endogenous regressor</p>
<ul>
<li><p>Based on F-statistic on excluded instruments in first stage</p></li>
<li><p>Critical values for set amount of bias or size distortion</p></li>
<li><p>Ex: when <span class="math inline">\(F=10\)</span> maximum TSLS bias is about 10% of OLS bias</p></li>
<li><p>Also when <span class="math inline">\(F=10\)</span>, the rejection rate of a 5% test is no more than 20%</p></li>
<li><p>As <span class="math inline">\(F\)</span> gets larger, relative bias shrinks and test size distortion falls</p></li>
<li><p><span class="math inline">\(F=10\)</span> is often called “Staiger Stock rule of thumb”, based on authors who developed it</p></li>
<li><p>Generally thought that when <span class="math inline">\(F&gt;10\)</span>, instruments are not weak</p></li>
</ul></li>
</ol>
</section>
<section id="instrument-relevance-5" class="level2">
<h2 class="anchored" data-anchor-id="instrument-relevance-5">Instrument Relevance</h2>
<ol start="2" type="1">
<li><p>Test with more than one endogenous regressor</p>
<ul>
<li><p>Suppose you have two endogenous variables and two instruments</p></li>
<li><p>You could compute a first stage <span class="math inline">\(F\)</span> for each endogenous variable</p></li>
<li><p>Problem arises when you have one instrument that is strong in both first stages</p></li>
<li><p>In this case you have one strong and one weak instrument</p></li>
<li><p>Cragg-Donald F-Statistic is modified F-stat for doing this test jointly</p></li>
</ul></li>
<li><p>Test that are heteroskedasticity-robust</p>
<ul>
<li><p>Both tests described above assume homoskedastic errors</p></li>
<li><p>Kelibergen-Paap adjusted the test for heteroskedasticity</p></li>
<li><p>Otherwise, works in the same way as described above</p></li>
</ul></li>
</ol>
</section>
<section id="instrument-relevance-6" class="level2">
<h2 class="anchored" data-anchor-id="instrument-relevance-6">Instrument Relevance</h2>
<ul>
<li>Finally, what if we fail the weak instrument tests?</li>
</ul>
<ol type="1">
<li><p>Find better instruments or drop weak ones</p>
<ul>
<li><p>If your model is overidentified, you can drop the weak instruments</p></li>
<li><p>If it is exactly identified, you could try to find better instruments</p>
<ul>
<li>This is not easy since instruments generally come from natural experiments</li>
</ul></li>
</ul></li>
<li><p>Use weak instrument robust inference</p>
<ul>
<li><p>As noted, t-tests will reject the null too often with weak instruments</p></li>
<li><p>You can adjust testing to have the correct size</p></li>
<li><p>There are several available</p>
<ul>
<li><p>Anderson Rubin (AR)</p></li>
<li><p>Conditional Likelihood Ration (CLR)</p></li>
<li><p>We will not cover the details of this, but all are available in Stata</p></li>
</ul></li>
</ul></li>
</ol>
</section>
</section>
<section id="interpretation-of-slope-in-iv-models" class="level1">
<h1>Interpretation of Slope in IV Models</h1>
<section id="introduction-5" class="level2">
<h2 class="anchored" data-anchor-id="introduction-5">Introduction</h2>
<ul>
<li><p>The Rubin model tells us how to interpret the slope in a regression model</p></li>
<li><p>Specific interpretation depends on assumptions</p>
<ul>
<li><p>If we make strong assumption that treatment is randomly assigned, regression slope is the average treatment effect (ATE)</p></li>
<li><p>Weaker assumption of mean independence or conditional mean independence of <span class="math inline">\(y_{0}\)</span> gives us average treatment effect on the treated (ATT)</p></li>
</ul></li>
<li><p>But in an instrumental variables model, these assumptions are violated</p>
<ul>
<li><p>The error term is correlated with treatment</p></li>
<li><p>So we cannot assume mean independence of the error</p></li>
</ul></li>
<li><p>In this section, we alter the Rubin model to interpret the slope in an IV model</p></li>
</ul>
</section>
<section id="local-average-treatment-effects" class="level2">
<h2 class="anchored" data-anchor-id="local-average-treatment-effects">Local Average Treatment Effects</h2>
<ul>
<li><p>Start with the observed outcomes from the Rubin model <span class="math display">\[y = y_{0} + (y_{1} -y_{0})w\]</span></p></li>
<li><p>Now suppose we have a binary instrument <span class="math inline">\(z\)</span></p>
<ul>
<li>This variable measures your <em>assignment</em> to treatment</li>
</ul></li>
<li><p>Define observed treatment as <span class="math display">\[w = w_{0} + (w_{1} -w_{0})z\]</span></p>
<ul>
<li><p><span class="math inline">\(w_{1}\)</span> is potential treatment when assigned to treatment</p></li>
<li><p><span class="math inline">\(w_{0}\)</span> is potential treatment when not assigned to treatment</p></li>
<li><p>We observe <span class="math inline">\(w=w_{0}\)</span> when <span class="math inline">\(z=0\)</span> and <span class="math inline">\(w=w_{1}\)</span> when <span class="math inline">\(z=1\)</span></p></li>
</ul></li>
</ul>
</section>
<section id="local-average-treatment-effects-1" class="level2">
<h2 class="anchored" data-anchor-id="local-average-treatment-effects-1">Local Average Treatment Effects</h2>
<ul>
<li><p>Assume that the instrument is independent of treatment and outcomes <span class="math display">\[(y_{0}, y_{1}, w_{0}, w_{1}) \perp z\]</span></p></li>
<li><p>The TSLS estimator is the reduced form divided by the first stage</p></li>
<li><p>In this setup with binary <span class="math inline">\(y\)</span>, the reduced form is</p>
<p><span class="math display">\[E(y|z=1) - E(y|z=0)\]</span></p></li>
<li><p>and with binary <span class="math inline">\(w\)</span> the first stage is</p>
<p><span class="math display">\[E(w|z=1) - E(w|z=0)\]</span></p></li>
<li><p>So that the IV estimator is</p>
<p><span class="math display">\[\frac{E(y|z=1) - E(y|z=0)}{E(w|z=1) - E(w|z=0)}\]</span></p></li>
</ul>
</section>
<section id="local-average-treatment-effects-2" class="level2">
<h2 class="anchored" data-anchor-id="local-average-treatment-effects-2">Local Average Treatment Effects</h2>
<ul>
<li><p>To get the numerator, first substitute <span class="math inline">\(w\)</span> equation into <span class="math inline">\(y\)</span> equation <span class="math display">\[y = y_{0} + (y_{1} -y_{0})w_{0} +  (y_{1} -y_{0})(w_{1} -w_{0})z\]</span></p></li>
<li><p>This allows us to write the following conditional expectations <span class="math display">\[E(y|z=1) = E(y_{0}) + E((y_{1} -y_{0})w_{0}) +  E((y_{1} -y_{0})(w_{1} -w_{0}))\]</span> <span class="math display">\[E(y|z=0) = E(y_{0}) + E((y_{1} -y_{0})w_{0})\]</span></p></li>
<li><p>So, <span class="math display">\[E(y|z=1) - E(y|z=0) =  E((y_{1} -y_{0})(w_{1} -w_{0}))\]</span></p></li>
</ul>
</section>
<section id="local-average-treatment-effects-3" class="level2">
<h2 class="anchored" data-anchor-id="local-average-treatment-effects-3">Local Average Treatment Effects</h2>
<ul>
<li><p>Note that <span class="math display">\[E((y_{1} -y_{0})(w_{1} -w_{0}))\]</span> <span class="math display">\[= E(y_{1} -y_{0}|w_{1} -w_{0} = 1)P(w_{1} -w_{0} = 1)\]</span> <span class="math display">\[- E(y_{1} -y_{0}|w_{1} -w_{0} = -1)P(w_{1} -w_{0} = -1)\]</span> <span class="math display">\[+0\times E(y_{1} -y_{0}|w_{1} -w_{0} = 0)P(w_{1} -w_{0} = 0)\]</span></p></li>
<li><p>The last term drops out since it is zero</p></li>
<li><p>Reduced form is the difference in treatment effect between two groups</p>
<ul>
<li><p><span class="math inline">\(E(y_{1} -y_{0}|w_{1} -w_{0} = 1)\)</span> is the treatment effect for “compliers”</p>
<ul>
<li>Compliers have <span class="math inline">\(w_{1}=1\)</span> and <span class="math inline">\(w_{0} = 0\)</span>, so that <span class="math inline">\(w_{1} -w_{0} = 1\)</span></li>
</ul></li>
<li><p><span class="math inline">\(E(y_{1} -y_{0}|w_{1} -w_{0} = -1)\)</span> is the treatment effect for “defiers”</p>
<ul>
<li>Defiers have <span class="math inline">\(w_{1}=0\)</span> and <span class="math inline">\(w_{0} = 1\)</span>, so that <span class="math inline">\(w_{1} -w_{0} = -1\)</span></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="local-average-treatment-effects-4" class="level2">
<h2 class="anchored" data-anchor-id="local-average-treatment-effects-4">Local Average Treatment Effects</h2>
<ul>
<li><p>Problem: reduced form might be 0 even with positive treatment effects for both groups</p>
<ul>
<li><p>Suppose <span class="math inline">\(E(y_{1} -y_{0}|w_{1} -w_{0} = 1) = E(y_{1} -y_{0}|w_{1} -w_{0} = -1)\)</span></p></li>
<li><p>Then <span class="math inline">\(E(y|z=1) - E(y|z=0) = 0\)</span> and reduced form effect is zero</p></li>
<li><p>Makes it difficult to measure treatment effects</p></li>
</ul></li>
<li><p>To correct for this, we must assume <strong>monotonicity</strong> <span class="math display">\[w_{1} \ge w_{0}\]</span></p>
<ul>
<li><p>Says effect of instrument goes one way</p></li>
<li><p>If assigned to treatment you take it, if not you don’t take it</p></li>
<li><p>Precludes defiers who don’t take treatment when assigned, take it when not assigned</p></li>
</ul></li>
</ul>
</section>
<section id="local-average-treatment-effects-5" class="level2">
<h2 class="anchored" data-anchor-id="local-average-treatment-effects-5">Local Average Treatment Effects</h2>
<ul>
<li><p>Monotonicity implies <span class="math inline">\(P(w_{1} -w_{0} = -1) = 0\)</span>, so <span class="math display">\[E(y|z=1) - E(y|z=0)\]</span> <span class="math display">\[= E(y_{1} -y_{0}|w_{1} -w_{0} = 1)P(w_{1} -w_{0} = 1)\]</span></p></li>
<li><p>With monotonicity <span class="math inline">\((w_{1} -w_{0})\)</span> can equal 0 or 1, so</p>
<p><span class="math display">\[E(w_{1} - w_{0}) = 1\times P(w_{1} -w_{0} = 1) + 0\times P(w_{1} -w_{0} = 0)\]</span> <span class="math display">\[=P(w_{1} -w_{0} = 1)\]</span></p></li>
<li><p>Using this in the reduced form gives us</p>
<p><span class="math display">\[E(y|z=1) - E(y|z=0)\]</span> <span class="math display">\[= E(y_{1} -y_{0}|w_{1} -w_{0} = 1)E(w_{1} -w_{0})\]</span></p></li>
</ul>
</section>
<section id="local-average-treatment-effects-6" class="level2">
<h2 class="anchored" data-anchor-id="local-average-treatment-effects-6">Local Average Treatment Effects</h2>
<ul>
<li><p>To derive the denominator, remember potential treatment are independent of <span class="math inline">\(z\)</span> <span class="math display">\[E(w |z=1) -E(w|z = 0) = E(w_{1} -w_{0})\]</span></p></li>
<li><p>Combining the numerator and denominator <span class="math display">\[\frac{E(y|z=1) - E(y|z=0)}{E(w|z=1) - E(w|z=0)} = \frac{E(y_{1} -y_{0}|w_{1} -w_{0} = 1)E(w_{1} -w_{0}) }{E(w_{1} -w_{0}) }\]</span></p>
<p><span class="math display">\[= E(y_{1} -y_{0}|w_{1} -w_{0} = 1)\]</span></p></li>
<li><p>Says the IV estimator equals <span class="math inline">\(E(y_{1} -y_{0}|w_{1} -w_{0} = 1)\)</span></p>
<ul>
<li><p>This is known as the <strong>Local Average Treatment Effect (LATE)</strong></p></li>
<li><p>The average treatment effect among compliers</p></li>
<li><p>Can interpret as treatment effect among people influenced by instrument</p></li>
</ul></li>
</ul>
</section>
<section id="examples-of-late" class="level2">
<h2 class="anchored" data-anchor-id="examples-of-late">Examples of LATE</h2>
<ul>
<li><p>Smith (2009)</p>
<ul>
<li><p>Effect of school entry age on test scores</p></li>
<li><p>Uses “assigned entry age” as instrument for actual entry age</p></li>
<li><p>LATE: measures effect of entry age on test scores for people who follow rules</p></li>
</ul></li>
<li><p>Angrist (1990)</p>
<ul>
<li><p>Effect of military service on earnings</p></li>
<li><p>Uses draft eligibility as determined by lottery as instrument for military service</p></li>
<li><p>LATE: measures effect of military service for those who complied with the draft lottery</p></li>
</ul></li>
<li><p>Key: often the “complier” subpopulation is different from the average population</p>
<ul>
<li>So LATE <span class="math inline">\(\neq\)</span> ATE in general</li>
</ul></li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>